server {
  listen 4000;

  # Authentification
  location /api/v1/auth/token {
    proxy_pass http://back-auth:3000;
    proxy_pass_request_body off;
    proxy_set_header Content-Length "";
    proxy_set_header X-Original-URI $request_uri;
  }
  
  # Microservices
  location /api/v1/auth {
    proxy_pass http://back-auth:3000;
  }
  location /api/v1/cdn {
    proxy_pass http://back-cdn:3000;
  }
  location /api/v1/restaurants {
    auth_request /api/v1/auth/token;
    proxy_pass http://back-restaurants:3000;
  }
  location /api/v1/articles {
    proxy_pass http://back-restaurants:3000;
  }
  location /api/v1/menus {
    proxy_pass http://back-restaurants:3000;
  }
  location /api/v1/articleCategories {
    proxy_pass http://back-restaurants:3000;
  }
  location /api/v1/restaurantCategories {
    proxy_pass http://back-restaurants:3000;
  }
}

client_max_body_size 2M;